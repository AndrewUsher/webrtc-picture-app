'use strict';var width=500;var height=0;var filter='none';var streaming=false;var video=document.querySelector('video');var canvas=document.querySelector('canvas');var photos=document.querySelector('.images');var photoButton=document.getElementById('photo-button');var clearButton=document.getElementById('clear-button');var photoFilter=document.getElementById('photo-filter');var options={video:true,audio:false};navigator.mediaDevices.getUserMedia(options).then(function(stream){video.srcObject=stream;video.play()}).catch(function(error){console.log('Error '+error)});video.addEventListener('canplay',function(event){if(!streaming){height=video.videoHeight/(video.videoWidth/width);video.setAttribute('width',width);video.setAttribute('height',height);canvas.setAttribute('width',width);canvas.setAttribute('height',height);streaming=true}},false);photoButton.addEventListener('click',function(event){takePicture();event.preventDefault()},false);clearButton.addEventListener('click',function(event){photos.textContent='';filter='none';video.style.filter=filter;photoFilter.selectedIndex=0});photoFilter.addEventListener('change',function(event){filter=event.target.value;video.style.filter=filter;event.preventDefault()});function takePicture(){var ctx=canvas.getContext('2d');if(width&&height){canvas.width=width;canvas.height=height;ctx.drawImage(video,0,0,width,height);var imgUrl=canvas.toDataURL('image/png');var img=document.createElement('img');img.setAttribute('src',imgUrl);img.style.filter=filter;photos.appendChild(img)}}